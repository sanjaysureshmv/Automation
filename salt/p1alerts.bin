

 This is for ELK

-------------------------

headused
already deere----collectd_elasticsearch_percent{elasticsearch="bb_IN_elk_prod",type="jvm.mem.heap-used-percent"}> 75
ram
collectd_memory_percent{memory="free",exported_instance=~"B020APP.*"} < 10


cpu
--collectd_aggregation_percent{aggregation="cpu-average",exported_instance=~"B0(20|21)APP.*" }> 86 --(for both elk and cassandara)

indexes

collectd_elasticsearch_counter_total{elasticsearch="bb_IN_elk_prod",type="indices.get.total"} > 0


Cassandra(21)
-----------
Heap Memory used


(collectd_GenericJMX_memory{GenericJMX="cassandra_java_memory",type="heap-used"} / IGNORING(type) collectd_GenericJMX_memory{GenericJMX="cassandra_java_memory",type="heap-max"} * 100 ) > 65

cpu


# 											Alert Rules for  [[ ElasticSearch , Cassandra, Kibana ]]


ALERT DevOpsPlaformCPU

 IF (collectd_aggregation_percent{aggregation="cpu-average",exported_instance=~"B0(20|21|03)APP.*" }> 86)
 For 3m
 LABELS {
 	infra_grp="devops", severity="critical"
 	}
 
 ANNOTATIONS {
 description="{{$labels.job}} on {{$labels.instance}} on {{$labels.node}} value {{ $value }}",
 summary="Processor alerts for {{$labels.instance}} "}




ALERT DevOpsPlatformHeap
	
 IF (collectd_elasticsearch_percent{elasticsearch="bb_IN_elk_prod",type="jvm.mem.heap-used-percent"}> 75 or 

 (collectd_GenericJMX_memory{GenericJMX="cassandra_java_memory",type="heap-used"} / IGNORING(type) collectd_GenericJMX_memory{GenericJMX="cassandra_java_memory",type="heap-max"} * 100 ) > 65  )

 FOR 3m

 LABELS {
 	infra_grp="devops", severity="critical"
 	}
 
 ANNOTATIONS {
 description="{{$labels.job}} on {{$labels.instance}} on {{$labels.node}} value {{ $value }}",
 summary="HeapMemory alerts for {{$labels.instance}} "}



ALERT DevOpsPlatformRAM
 IF(collectd_memory_percent{memory="free",exported_instance=~"B0(20|21)APP.*"} < 15)

 FOR 3m

 LABELS {
 	infra_grp="devops", severity="critical"
 	}
 
 ANNOTATIONS {
 description="{{$labels.job}} on {{$labels.instance}} on {{$labels.node}} value {{ $value }}",
 summary="RAM alerts for {{$labels.instance}} "}


ALERT DevOpsELKIndices
 IF (collectd_elasticsearch_counter_total{elasticsearch="bb_IN_elk_prod",type="indices.get.total"} > 0)

 FOR 3m

 LABELS {
 	infra_grp="devops", severity="critical"
 	}
 
 ANNOTATIONS {
 description="{{$labels.job}} on {{$labels.instance}} on {{$labels.node}} value {{ $value }}",
 summary="ElasticSearch Indices alerts for {{$labels.instance}} "}


ALERT DevOpsNodeup

 IF(consul_catalog_service_node_healthy{node=~"B0(07|02|25|03|20|21|22|23)APP.*"}!=1)

	
FOR 3m

 LABELS {
 	infra_grp="devops", severity="critical"
 	}
 
 ANNOTATIONS {
 description="{{$labels.job}} on {{$labels.instance}} on {{$labels.node}} value {{ $value }}",
 summary="Node Health alerts for {{$labels.instance}} "}